var subtopic=function(){"use strict";var e={},s=function(s,t){for(var a=s.split("/");a[0];){if(e[s]){var i=e[s],n=i.length-1;for(n;n>=0;n-=1){var r=i[n].ctx||this,o=i[n].cb;o.apply(r,t||[])}}a.pop(),s=a.join("/")}},t=function(s,t,a){return e[s]||(e[s]=[]),e[s].push({cb:t,ctx:a}),[s,{cb:t,ctx:a}]},a=function(s,t){var a=s[0],i=e[a].length-1;if(e[a])for(i;i>=0;i-=1)e[a][i]===s[1]&&(e[a].splice(e[a][i],1),t&&delete e[a])};return{publish:s,subscribe:t,unsubscribe:a}},globalPathway=subtopic();console.log(globalPathway);var isMessage=function(e,s){return e.Name===s},Cell=function(e,s,t,a){for(var i={Needs:e,Produces:s,MessagePathway:a,BindingSite:function(e){t(this,e)},PublishSite:function(e){console.log("Published message",e),this.MessagePathway.publish(e.Name,[e])}},n=0;n<e.length;n++)a.subscribe(e[n],i.BindingSite,i);return i},Tissue=function(e,s,t){return{CellFactorySites:e,ParentMessagePathway:t,MessagePathway:s,Relay:function(e){console.log("Tissue relayed",e),this.MessagePathway.publish(e.Name,[e])},Grow:function(){for(var e=[],s=[],t=0;t<this.CellFactorySites.length;t++)e.push(this.CellFactorySites[t](this.MessagePathway));for(var a=0;a<e.length;a++)for(var i=e[a],n=0;n<i.Needs.length;n++)-1===s.indexOf(i.Needs[n])&&s.push(i.Needs[n]);for(var r=0;r<s.length;r++)this.ParentMessagePathway.subscribe(s[r],this.Relay,this)}}};